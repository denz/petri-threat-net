<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>login_net.py</title>
  <link rel="stylesheet" href="pycco.css">
</head>
<body>
<div id="background"></div>
<div id='container'>
  <div class='section'>
    <div class='docs'><h1>login_net.py</h1></div>
  </div>
  <div class='clearall'>
  <div class='section' id='section-0'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-0'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>
<span class="kn">from</span> <span class="nn">ptr.render</span> <span class="kn">import</span> <span class="n">D3Net</span>

<span class="kn">from</span> <span class="nn">ptr.reachability</span> <span class="kn">import</span> <span class="n">Graph</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-1'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-1'>#</a>
      </div>
      <p>this is a login net described in <code>Automated security test generation with formal threat models.pdf</code></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-2'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-2'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">illegal_attempt_guard</span><span class="p">(</span><span class="n">u</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;(?u,?p)[?u!=&quot;&quot;]&#39;&#39;&#39;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-3'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-3'>#</a>
      </div>
      <p>define a guard function</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-4'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-4'>#</a>
      </div>
      <p>autodoc string above will be a guard text for rendered html</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">return</span> <span class="n">u</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-5'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-5'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">legal_attempt_to_p1_arc_label</span><span class="p">(</span><span class="n">tokens</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-6'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-6'>#</a>
      </div>
      <p>legal attempt label function</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-7'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-7'>#</a>
      </div>
      <p>just return an empty token, dont care about inputs</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">return</span> <span class="p">{}</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-8'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-8'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">example_label_function</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="n">u</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-9'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-9'>#</a>
      </div>
      <p>example label function
defines that <code>('u', 'p')</code> is a label variables</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-10'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-10'>#</a>
      </div>
      <p>this label function selects first token but can be programmed to do anything</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">return</span> <span class="n">tokens</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-11'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-11'>#</a>
      </div>
      <p>create a login net with 5 places
(D3 prefix stands for <code>d3.js</code> visualization method)</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">net</span> <span class="o">=</span> <span class="n">D3Net</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="s">&#39;p</span><span class="si">%s</span><span class="s">&#39;</span><span class="o">%</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)])</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-12'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-12'>#</a>
      </div>
      <p>define transitions between places
each <code>bind</code> call defines one transition</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">net</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-13'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-13'>#</a>
      </div>
      <p>name of transition</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="s">&#39;startLogin&#39;</span><span class="p">,</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-14'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-14'>#</a>
      </div>
      <p>define input arcs.
dictionary keys defines a label.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-15'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-15'>#</a>
      </div>
      <p>dictionary items defines a set of places bound with this transition as input output or inhibitor</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>         <span class="n">inputs</span><span class="o">=</span><span class="p">{():(</span><span class="n">net</span><span class="o">.</span><span class="n">places</span><span class="p">[</span><span class="s">&#39;p0&#39;</span><span class="p">],)},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-16'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-16'>#</a>
      </div>
      <p>define output arcs</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>         <span class="n">outputs</span><span class="o">=</span><span class="p">{():(</span><span class="n">net</span><span class="o">.</span><span class="n">places</span><span class="p">[</span><span class="s">&#39;p1&#39;</span><span class="p">],)})</span>

<span class="n">net</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&#39;legalAttempt&#39;</span><span class="p">,</span>
         <span class="n">inputs</span><span class="o">=</span><span class="p">{():(</span><span class="n">net</span><span class="o">.</span><span class="n">places</span><span class="p">[</span><span class="s">&#39;p1&#39;</span><span class="p">],),</span>
                 <span class="p">(</span><span class="s">&#39;u&#39;</span><span class="p">,</span> <span class="s">&#39;p&#39;</span><span class="p">):(</span><span class="n">net</span><span class="o">.</span><span class="n">places</span><span class="p">[</span><span class="s">&#39;p2&#39;</span><span class="p">],)</span>
                <span class="p">},</span>
         <span class="n">outputs</span><span class="o">=</span><span class="p">{</span><span class="n">legal_attempt_to_p1_arc_label</span><span class="p">:(</span><span class="n">net</span><span class="o">.</span><span class="n">places</span><span class="p">[</span><span class="s">&#39;p1&#39;</span><span class="p">],)})</span>

<span class="n">net</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&#39;illegalAttempt&#39;</span><span class="p">,</span>
         <span class="n">guard</span><span class="o">=</span><span class="n">illegal_attempt_guard</span><span class="p">,</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-17'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-17'>#</a>
      </div>
      <p>Label can be a tuple or function with keyword args</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>         <span class="n">inputs</span><span class="o">=</span><span class="p">{(</span><span class="s">&#39;u&#39;</span><span class="p">,</span> <span class="s">&#39;p&#39;</span><span class="p">):(</span><span class="n">net</span><span class="o">.</span><span class="n">places</span><span class="p">[</span><span class="s">&#39;p3&#39;</span><span class="p">],)},</span>
         <span class="n">outputs</span><span class="o">=</span><span class="p">{():(</span><span class="n">net</span><span class="o">.</span><span class="n">places</span><span class="p">[</span><span class="s">&#39;p4&#39;</span><span class="p">],)},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-18'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-18'>#</a>
      </div>
      <p>define inhibitor arcs</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>         <span class="n">inhibitors</span><span class="o">=</span><span class="p">{(</span><span class="s">&#39;u&#39;</span><span class="p">,</span> <span class="s">&#39;p&#39;</span><span class="p">):(</span><span class="n">net</span><span class="o">.</span><span class="n">places</span><span class="p">[</span><span class="s">&#39;p2&#39;</span><span class="p">],)}</span>
        <span class="p">)</span>

<span class="n">net</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&#39;attack&#39;</span><span class="p">,</span>
         <span class="n">inputs</span><span class="o">=</span><span class="p">{():(</span><span class="n">net</span><span class="o">.</span><span class="n">places</span><span class="p">[</span><span class="s">&#39;p4&#39;</span><span class="p">],)},</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-19'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-19'>#</a>
      </div>
      <p>set this transition to be attack transition</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>         <span class="n">is_attack</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-20'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-20'>#</a>
      </div>
      <p>create initial marking</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">M0</span> <span class="o">=</span> <span class="p">{</span><span class="n">net</span><span class="o">.</span><span class="n">places</span><span class="p">[</span><span class="s">&#39;p1&#39;</span><span class="p">]:[{},],</span>
      <span class="n">net</span><span class="o">.</span><span class="n">places</span><span class="p">[</span><span class="s">&#39;p2&#39;</span><span class="p">]:[{</span><span class="s">&#39;u&#39;</span><span class="p">:</span><span class="s">&#39;ID1&#39;</span><span class="p">,</span> <span class="s">&#39;p&#39;</span><span class="p">:</span><span class="s">&#39;PSWD1&#39;</span><span class="p">},</span>
                        <span class="p">{</span><span class="s">&#39;u&#39;</span><span class="p">:</span><span class="s">&#39;ID2&#39;</span><span class="p">,</span> <span class="s">&#39;p&#39;</span><span class="p">:</span><span class="s">&#39;PSWD2&#39;</span><span class="p">},</span>
                        <span class="p">{</span><span class="s">&#39;u&#39;</span><span class="p">:</span><span class="s">&#39;ID3&#39;</span><span class="p">,</span> <span class="s">&#39;p&#39;</span><span class="p">:</span><span class="s">&#39;PSWD3&#39;</span><span class="p">}],</span>

      <span class="n">net</span><span class="o">.</span><span class="n">places</span><span class="p">[</span><span class="s">&#39;p3&#39;</span><span class="p">]:[{</span><span class="s">&#39;u&#39;</span><span class="p">:</span><span class="s">&#39;ID4&#39;</span><span class="p">,</span> <span class="s">&#39;p&#39;</span><span class="p">:</span><span class="s">&#39;PSWD4&#39;</span><span class="p">},</span>
                        <span class="p">{</span><span class="s">&#39;u&#39;</span><span class="p">:</span><span class="s">&#39;ID5&#39;</span><span class="p">,</span> <span class="s">&#39;p&#39;</span><span class="p">:</span><span class="s">&#39;PSWD5&#39;</span><span class="p">},</span>
                        <span class="p">{</span><span class="s">&#39;u&#39;</span><span class="p">:</span><span class="s">&#39;ID6&#39;</span><span class="p">,</span> <span class="s">&#39;p&#39;</span><span class="p">:</span><span class="s">&#39;PSWD6&#39;</span><span class="p">}]</span>
     <span class="p">}</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-21'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-21'>#</a>
      </div>
      <p>render a current net state to html</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">net</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">marking</span><span class="o">=</span><span class="n">M0</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s">&#39;.&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-22'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-22'>#</a>
      </div>
      <p>create a reachability graph for login net and initial marking</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">M0</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-23'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-23'>#</a>
      </div>
      <p>pretty print a list of node sequences that leads to attcaks</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">pprint</span> <span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">attacks</span><span class="p">)</span>

</pre></div>
    </div>
  </div>
  <div class='clearall'></div>
</div>
</body>
